<!DOCTYPE html>
<html>
<head>
    <title>Test Mnemonic on Branch</title>
    <meta charset="utf-8">
</head>
<body>
    <h1>Mnemonic Address Generation Test</h1>
    <h2>Test Configuration:</h2>
    <ul>
        <li><strong>Mnemonic:</strong> oxygen lobster melody price ribbon home clip doll trigger glove silly market</li>
        <li><strong>Coin:</strong> BTC - Bitcoin</li>
        <li><strong>Derivation Path:</strong> m/44'/0'/0'/0</li>
    </ul>
    
    <h2>Expected Addresses (from test suite):</h2>
    <pre id="expected">
m/44'/0'/0'/0/0: 174EEBMoDPvVdQHbtJJASxSrAChugdWVdi
m/44'/0'/0'/0/1: 195r9siycWtM3Uw7f9Hb15icN1AunnGNGT
m/44'/0'/0'/0/2: 1NPpXt7BN4TZpArP47aVJtHZroz5ZtYH2E
m/44'/0'/0'/0/3: 13Pekgkyd41Vzf1K1ZyzoXx9w1hMyndJ5u
m/44'/0'/0'/0/4: 1F2VbMzhzgwQqrpK2rCGnqGhxhxWgjP28M
    </pre>
    
    <h2>Generated Addresses on Current Branch:</h2>
    <div id="results">Loading...</div>
    
    <iframe id="testframe" src="/src/index.html" style="width: 100%; height: 600px; margin-top: 20px;"></iframe>
    
    <script>
        const TEST_MNEMONIC = "oxygen lobster melody price ribbon home clip doll trigger glove silly market";
        const EXPECTED_ADDRESSES = [
            "174EEBMoDPvVdQHbtJJASxSrAChugdWVdi",
            "195r9siycWtM3Uw7f9Hb15icN1AunnGNGT",
            "1NPpXt7BN4TZpArP47aVJtHZroz5ZtYH2E",
            "13Pekgkyd41Vzf1K1ZyzoXx9w1hMyndJ5u",
            "1F2VbMzhzgwQqrpK2rCGnqGhxhxWgjP28M"
        ];
        
        window.onload = function() {
            const iframe = document.getElementById('testframe');
            
            iframe.onload = function() {
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                
                setTimeout(() => {
                    // Enter mnemonic
                    const phraseInput = iframeDoc.querySelector('#phrase');
                    if (phraseInput) {
                        phraseInput.value = TEST_MNEMONIC;
                        const event = new Event('input', { bubbles: true });
                        phraseInput.dispatchEvent(event);
                        
                        // Wait for processing
                        setTimeout(() => {
                            // Check selected network
                            const networkSelect = iframeDoc.querySelector('.network');
                            const selectedNetwork = networkSelect ? networkSelect.options[networkSelect.selectedIndex].text : 'Unknown';
                            
                            // Check derivation path
                            const derivationPath = iframeDoc.querySelector('#bip44-path');
                            const pathValue = derivationPath ? derivationPath.value : 'Unknown';
                            
                            // Get addresses
                            const rows = iframeDoc.querySelectorAll('#addresses tbody tr');
                            let html = '<h3>Current Branch Results:</h3>';
                            html += '<p><strong>Selected Network:</strong> ' + selectedNetwork + '</p>';
                            html += '<p><strong>Derivation Path:</strong> ' + pathValue + '</p>';
                            html += '<table border="1" cellpadding="5" style="margin: 10px 0;">';
                            html += '<tr><th>Index</th><th>Path</th><th>Generated Address</th><th>Expected Address</th><th>Status</th></tr>';
                            
                            let allCorrect = true;
                            
                            for (let i = 0; i < Math.min(5, rows.length); i++) {
                                const cells = rows[i].querySelectorAll('td');
                                if (cells.length >= 2) {
                                    const path = cells[0].textContent;
                                    const address = cells[1].textContent;
                                    const expected = EXPECTED_ADDRESSES[i];
                                    const isCorrect = address === expected;
                                    
                                    if (!isCorrect) allCorrect = false;
                                    
                                    html += '<tr>';
                                    html += '<td>' + i + '</td>';
                                    html += '<td>' + path + '</td>';
                                    html += '<td>' + address + '</td>';
                                    html += '<td>' + expected + '</td>';
                                    html += '<td style="color: ' + (isCorrect ? 'green' : 'red') + '">';
                                    html += isCorrect ? '✓ CORRECT' : '✗ DIFFERENT';
                                    html += '</td>';
                                    html += '</tr>';
                                }
                            }
                            
                            html += '</table>';
                            
                            if (allCorrect) {
                                html += '<h2 style="color: green">✓ All addresses match expected values!</h2>';
                            } else {
                                html += '<h2 style="color: red">✗ Some addresses do not match!</h2>';
                                html += '<p>This indicates a problem with address generation on this branch.</p>';
                            }
                            
                            document.getElementById('results').innerHTML = html;
                        }, 3000);
                    }
                }, 1000);
            };
        };
    </script>
</body>
</html>